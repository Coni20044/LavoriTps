<html>
  <!DOCTYPE html>
  <style>
    body {
      font-family: Arial;
      background-color: olive;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      font-size: 40px;
      color: #000;
      margin-top: 30px;
    }
    input[type="file"] {
      padding: 20px;
      font-size: 1em;
      background-color: #cdcdcd;
      border: 4px solid #000;
      margin: 50px auto;
      display: block;
    }
    .contenitore {
      width: 300px;
      background-color: #cdcdcd;
      padding: 20px;
      border: 4px solid #000;
      margin: 20px auto;
      word-wrap: break-word;
    }
    button {
      font-size: 15px;
    }
  </style>
  <body>
    <h1>CRIPATORE DI TESTO</h1>
    <input type="file" onchange="caricaFile(this)" />
    <button onclick="invertiCodifica()">Decodifica</button>
    <div id="risultato" class="contenitore"></div>
    <script>
      let mappaCaratteri = ["q", "8", "h", "V", "C", "w", "j", "D", "r", "4", "L", "G", "p", "F", "o", "Z", "s", "X", "9", "u", "Y", "E", "n", "3", "T", "a", "k", "5", "m", "b", "I", "M", "6", "B", "i", "g", "A", "t", "N", "S", "y", "2", "U", "x", "z", "7", "O", "f", "P", "l", "R", "d", "J", "K", "H", "e", "W", "1", "c", "v", "Q", "0"];
      let contenutoTesto = "";
      let testoConvertito = "";
      function caricaFile(inputFile) {
        let documento = inputFile.files[0];
        let lettore = new FileReader();
        lettore.readAsText(documento);
        lettore.onload = function () {
          contenutoTesto = lettore.result;  
          testoConvertito = applicaCodifica(contenutoTesto); 
          document.getElementById("risultato").textContent = testoConvertito;
        };
      }
      function applicaCodifica(testo) {
        let testoFinale = "";
        for (let indice = 0; indice < testo.length; indice++) {
          let simbolo = testo.charAt(indice);
          if (mappaCaratteri.includes(simbolo)) {
            for (let posizione = 0; posizione < mappaCaratteri.length; posizione++) {
              if (mappaCaratteri[posizione] == simbolo) {
                simbolo = mappaCaratteri[(posizione + 13) % mappaCaratteri.length];
                break;
              }
            }
          }
          testoFinale += simbolo;
        }
        return testoFinale;
      }
      function invertiCodifica() {
        let testoOriginale = "";
        
        for (let indice = 0; indice < testoConvertito.length; indice++) {
          let simbolo = testoConvertito.charAt(indice);
          if (mappaCaratteri.includes(simbolo)) {
            for (let posizione = 0; posizione < mappaCaratteri.length; posizione++) {
              if (mappaCaratteri[posizione] == simbolo) {
                simbolo = mappaCaratteri[(posizione - 13 + mappaCaratteri.length) % mappaCaratteri.length];
                break;
              }
            }
          }
          testoOriginale += simbolo;
        }
        document.getElementById("risultato").textContent = testoOriginale;
      }
    </script>
  </body>
</html>
