<link rel="stylesheet" href="tabellaAnagrafica.css">
<html>
<head>
    <style>
       body {
    font-family: Arial, sans-serif;
    background: #1b1b1b;
    color: #f0f0f0;
    margin: 0;
    padding: 20px;
    text-align: center;
}

h1 {
    text-align: center;
    color: #ff4444;
    font-size: 40px;
    margin-bottom: 30px;
}

table {
    width: 70%;
    margin: 20px auto;
    border-collapse: collapse;
    background: #2a2a2a;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
    border-radius: 8px;
    overflow: hidden;
    text-align: center;
}

th {
    background: #ff4444;
    padding: 12px;
    text-transform: uppercase;
    font-weight: bold;
    letter-spacing: 1px;
    border-bottom: 2px solid #000;
}

td {
    padding: 10px;
    border-bottom: 1px solid #444;
    text-align: center;
}

tr:nth-child(even) {
    background: #242424;
}

input[type="button"] {
    background: #ff4444;
    color: #fff;
    border: none;
    padding: 10px 15px;
    margin: 10px auto;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
    display: block;
}

input[type="button"]:hover {
    background: #cc0000;
}

select, input[type="number"] {
    padding: 8px;
    margin: 10px;
    border-radius: 5px;
    border: 1px solid #555;
    background: #2a2a2a;
    color: #fff;
}

p {
    width: 60%;
    margin: 10px auto;
    padding: 10px;
    background: #2a2a2a;
    border-radius: 6px;
    min-height: 20px;
    box-shadow: inset 0 0 4px rgba(0,0,0,0.5);
    text-align: center;
}
    </style>
    
    <script>
        let parseJSON= [] 
        let filehttp 

        function caricaDatiJ() {
            const richiesta = new XMLHttpRequest()
            richiesta.open("GET", "https://coni20044.github.io/LavoriTps/2025/ListaNera.json", true)
            richiesta.send()

            richiesta.onload = function () {
                parseJSON = JSON.parse(richiesta.responseText);
            }
        }

        function caricaDatiX(){
            const richiesta= new XMLHttpRequest(); 
            richiesta.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) { 
                myFunction(this);
                }
            };
            richiesta.open("GET", "https://coni20044.github.io/LavoriTps/2025/ListaNera.xml", true);
            richiesta.send();
            function myFunction(file) {
                filehttp = file.responseXML;
            }
        }

        function letturaX(){
            let vittime= filehttp.documentElement.children 
            let campi= vittime[0].children; 
            let tabella=document.createElement("table")

            let intestazioneRow=document.createElement("tr")
            for(let i=0; i<campi.length; i++){
                let intestazione=document.createElement("th")
                intestazione.textContent = campi[i].tagName 
                intestazioneRow.appendChild(intestazione)
            }
            tabella.appendChild(intestazioneRow)

            for(let i=0; i<vittime.length; i++){
                let riga= document.createElement("tr")
                let dati = vittime[i].children 
                for(let j=0; j<dati.length; j++){
                    let intestazione = document.createElement("td")
                    intestazione.textContent = dati[j].textContent 
                    riga.appendChild(intestazione)
                }
                tabella.appendChild(riga)
            }
            document.getElementById("outputX").appendChild(tabella)
        }

        function lettura(){
            let tabella= document.createElement("table")
            const chiavi=Object.keys(parseJSON[0])
            let intestazioneRow=document.createElement("tr")

            for(let i=0; i<chiavi.length; i++){
                let intestazione=document.createElement("th");
                intestazione.textContent= chiavi[i];
                intestazioneRow.appendChild(intestazione)  
            }
            tabella.appendChild(intestazioneRow)

            for(let i=0; i<parseJSON.length ;i++){
                let righe= document.createElement("tr");
                for(let j=0; j<chiavi.length; j++ ){
                    let colonne= document.createElement("td")
                    colonne.textContent = parseJSON[i][chiavi[j]]
                    righe.appendChild(colonne)
                }
                tabella.appendChild(righe)
            }   
            let output= document.getElementById("output")
            output.appendChild(tabella);
        }

        function maggiorenni(){ 
            let maggiorenni="" 
            for(let i=0;i<parseJSON.length; i++){
                if(parseJSON[i]["età"]>18){
                    maggiorenni += parseJSON[i]["cognome"] + " " + parseJSON[i]["età"] + "<br>"
                }
            }
            document.getElementById("outputM").innerHTML = maggiorenni
        }

        function ricerca(){
            let lettera=document.getElementById("ricerca").value
            let cognomi="I cognomi che iniziano con " + lettera + " sono: "
            for (let i = 0; i < parseJSON.length; i++) {
                if(parseJSON[i]["cognome"].startsWith(lettera))
                    cognomi += parseJSON[i]["cognome"] +"<br>"
            }
            document.getElementById("outputC").innerHTML = cognomi
        }

        function generazione(){
            let anno = document.getElementById("eta").value;
            let generazione = "";
            if (anno >= 1901 && anno <= 1927) {
                generazione = "Appartieni alla Greatest Generation (1901-1927)";
            } else if (anno >= 1928 && anno <= 1945) {
                generazione = "Appartieni alla Generazione Silenziosa (1928-1945)";
            } else if (anno >= 1946 && anno <= 1964) {
                generazione = "Appartieni ai Baby Boomers (1946-1964)";
            } else if (anno >= 1965 && anno <= 1980) {
                generazione = "Appartieni alla Generazione X (1965-1980)";
            } else if (anno >= 1981 && anno <= 1996) {
                generazione = "Appartieni ai Millenials (1981-1996)";
            } else if (anno >= 1997 && anno <= 2012) {
                generazione = "Appartieni alla Generazione Z (1997-2012)";
            } else if (anno >= 2013) {
                generazione = "Appartieni alla Generazione Alpha (dal 2013 in poi)";
            } else {
                generazione = "Anno di nascita non valido";
            }
            document.getElementById("outputG").innerHTML = generazione
        }

        function caricaDati(){
            caricaDatiX()
            caricaDatiJ()
        }
    </script>
    
</head>

<body onload="caricaDati()">

    <h1>Tabella Anagrafica</h1>

   <p id="output"></p>
   <p id="outputX"></p>

    <input type="button" value="visualizza JSON" onclick="lettura()">
    <input type="button" value="visualizza XML" onclick="letturaX()">

    <label for="ricerca">Inserisci la lettera dei cognomi da cercare:</label>
    <select id="ricerca" name="ricerca">
     <option value="A">A</option>
     <option value="B">B</option>
     <option value="C">C</option>
     <option value="D">D</option>
     <option value="E">E</option>
     <option value="F">F</option>
     <option value="G">G</option>
     <option value="H">H</option>
     <option value="I">I</option>
     <option value="J">J</option>
     <option value="K">K</option>
     <option value="L">L</option>
     <option value="M">M</option>
     <option value="N">N</option>
     <option value="O">O</option>
     <option value="P">P</option>
     <option value="Q">Q</option>
     <option value="R">R</option>
     <option value="S">S</option>
     <option value="T">T</option>
     <option value="U">U</option>
     <option value="V">V</option>
     <option value="W">W</option>
     <option value="X">X</option>
     <option value="Y">Y</option>
     <option value="Z">Z</option>
  </select>

  <input type="button" value="Ricerca Cognomi JSON" onclick="ricerca()">
  <p id="outputC"></p>

  <input type="number" id="eta" name="età">
  <input type="button" value="Inserisci anno di nascita e scopri la tua generazione" onclick="generazione()">
  <p id="outputG"></p>

  <input type="button" value="Stampa maggiorenni JSON" onclick="maggiorenni()">
  <p id="outputM"></p>
  
</body>
</html>
